<!DOCTYPE html>
<html lang="en">
{% load static %}

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CMMS-Software</title>
  <meta name="description"
        content="Connect with iEngineering Australia today. We’re here to help with software, automation, and asset management solutions across Asia-Pacific.">

  <!--=============== CSS ===============-->
  <link rel="stylesheet" href="{% static 'css/home.css' %}">
  <link rel="stylesheet" href="{% static 'css/footer.css' %}">
  <link rel="stylesheet" href="{% static 'css/contact.css' %}">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="icon" href="{% static 'images/logo1.png' %}">

  <!-- Google Tag Manager -->
  <script>
    (function (w, d, s, l, i) {
      w[l] = w[l] || [];
      w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
      var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
      j.async = true;
      j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
      f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-TKQV8LKX');
  </script>
  <!-- End Google Tag Manager -->
</head>

<body>
  {% include 'header.html' %}

  <section class="cmms-contact-form-section" style="background-image: url('../static/images/banner/about.png');">
    <div class="cmms-contact-form-overlay"></div>
    <div class="cmms-contact-form-container">
      <a href="#contact" style="color: white;">
        <span class="cmms-contact-form-badge">
          <span class="cmms-contact-form-dot"></span> Contact us
        </span>
      </a>
      <h1 class="cmms-contact-form-title">Get in touch</h1>
    </div>
  </section>

  <section class="cmms-contact-form-wrap">
    <div class="cmms-contact-form-inner">

      <a href="#contact" class="cmms-contact-form-badge2">
        <span class="cmms-contact-form-dot2"></span> Contact us
      </a>

      <h2 class="cmms-contact-form-heading2">
        Say hello – we’re always just <br /> a click away!
      </h2>

      {% if sent %}
      <div class="cmms-contact-form-success2">Thanks! We’ll be in touch shortly.</div>
      {% endif %}

      <!-- CONTACT FORM (normal POST, spinner on button) -->
      <form
        action="{% url 'cmmsApp:contact_section' %}"
        data-post-url="{% url 'cmmsApp:contact_section' %}"
        method="post"
        novalidate
        class="cmms-contact-form-form2"
        id="contact"
      >
        {% csrf_token %}

        <div class="cmms-contact-form-grid2">
          <div class="cmms-contact-form-field2">
            {% if form.first_cname.errors %}
            <div class="cmms-contact-form-error" style="color: red;">
              {% for error in form.first_name.errors %}<p>{{ error }}</p>{% endfor %}
            </div>
            {% endif %}
            <label class="cmms-contact-form-label2" for="id_first_name">Your name *</label>
            <input type="text" name="{{ form.first_name.name }}"
                   value="{{ form.first_name.value|default_if_none:'' }}"
                   class="cmms-contact-form-input2"
                   id="id_first_name" required />
          </div>

          <div class="cmms-contact-form-field2">
            {{ form.last_name.errors }}
            <label class="cmms-contact-form-label2">Last name</label>
            <input type="text" name="{{ form.last_name.name }}"
                   value="{{ form.last_name.value|default_if_none:'' }}"
                   class="cmms-contact-form-input2" />
          </div>
        </div>

        <div class="cmms-contact-form-grid2">
          <div class="cmms-contact-form-field2">
            {{ form.company.errors }}
            <label class="cmms-contact-form-label2">Company name</label>
            <input type="text" name="{{ form.company.name }}"
                   value="{{ form.company.value|default_if_none:'' }}"
                   class="cmms-contact-form-input2" />
          </div>

          <div class="cmms-contact-form-field2">
            <label class="cmms-contact-form-label2" for="id_country">Country *</label>
            <select name="{{ form.country.name }}" class="cmms-contact-form-input2" id="id_country" required>
              {% for val, label in form.country.field.choices %}
                {% if form.country.value|stringformat:"s" == val|stringformat:"s" %}
                  <option value="{{ val }}" selected>{{ label }}</option>
                {% else %}
                  <option value="{{ val }}">{{ label }}</option>
                {% endif %}
              {% endfor %}
            </select>

            {% if form.country.errors %}
            <div class="cmms-contact-form-error" style="color: red;">
              {% for error in form.country.errors %}<p>{{ error }}</p>{% endfor %}
            </div>
            {% endif %}
          </div>
        </div>

        <div class="cmms-contact-form-field2">
          {% if form.email.errors %}
          <div class="cmms-contact-form-error" style="color: red;">
            {% for error in form.email.errors %}<p>{{ error }}</p>{% endfor %}
          </div>
          {% endif %}
          <label class="cmms-contact-form-label2" for="id_email">Email address *</label>
          <input type="email" name="{{ form.email.name }}"
                 value="{{ form.email.value|default_if_none:'' }}"
                 class="cmms-contact-form-input2"
                 id="id_email" required />
        </div>

        <div class="cmms-contact-form-field2">
          {{ form.phone.errors }}
          <label class="cmms-contact-form-label2">Phone (include country code, e.g. +61 4…)</label>
          <input type="text" name="{{ form.phone.name }}"
                 value="{{ form.phone.value|default_if_none:'' }}"
                 class="cmms-contact-form-input2" />
        </div>

        <div class="cmms-contact-form-field2">
          {{ form.message.errors }}
          <label class="cmms-contact-form-label2">Enter your message</label>
          <textarea name="{{ form.message.name }}" rows="6" class="cmms-contact-form-textarea2"></textarea>
        </div>

        <button type="submit" id="contactSubmit" class="cmms-contact-form-submit2">
          Submit
        </button>
      </form>

      <!-- Optional: if you still want a message below (not required) -->
      <div id="loadingSpinner" style="display:none;">Submitting...</div>
    </div>
  </section>

  <section class="cmms-contact-form-loc-wrap">
    <div class="cmms-contact-form-loc-grid">

      <!-- Australia – Sydney -->
      <article class="cmms-contact-form-loc-card cmms-contact-form-loc-card--au">
        <header class="cmms-contact-form-loc-header">
          <span class="cmms-contact-form-loc-icon">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7zm0 9.5A2.5 2.5 0 1 1 12 6a2.5 2.5 0 0 1 0 5.5z" />
            </svg>
          </span>
          <h3 class="cmms-contact-form-loc-title">Australia – Sydney</h3>
        </header>
        <p class="cmms-contact-form-loc-phone"><strong>Phone:</strong> +61 (02) 8318 1490</p>
        <p class="cmms-contact-form-loc-email"><strong>Email: </strong><a href="mailto:enquiries@iengaust.com.au">enquiries@iengaust.com.au</a></p>
        <p class="cmms-contact-form-loc-address">Warawara Cct, Quakers Hill NSW 2763, Australia</p>
        <a class="cmms-contact-form-loc-map" target="_blank" rel="noopener"
           href="https://www.google.com/maps?ll=-33.723524,150.875902&z=5&t=m&hl=en-US&gl=US&mapclient=embed&cid=2860432314088839065">
          View map
        </a>
      </article>

      <!-- India – Pune -->
      <article class="cmms-contact-form-loc-card cmms-contact-form-loc-card--in">
        <header class="cmms-contact-form-loc-header">
          <span class="cmms-contact-form-loc-icon">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7zm0 9.5A2.5 2.5 0 1 1 12 6a2.5 2.5 0 0 1 0 5.5z" />
            </svg>
          </span>
          <h3 class="cmms-contact-form-loc-title">India – Pune</h3>
        </header>
        <p class="cmms-contact-form-loc-phone"><strong>Phone: </strong>+91 9168627258</p>
        <p class="cmms-contact-form-loc-email"><strong>Email: </strong><a href="mailto:shila@iengaust.com.au">shila@iengaust.com.au</a></p>
        <p class="cmms-contact-form-loc-address">
          Navale IT Zone, Office No. 501, 5th Floor, A-Wing, Near Navale Bridge, Mumbai-Bangalore Highway,
          Narhe, Pune – 411041.
        </p>
        <a class="cmms-contact-form-loc-map" target="_blank" rel="noopener"
           href="https://www.google.com/maps/place/Navale+IT+Zone+Phase2/@18.4597518,73.8199254,17z/">
          View map
        </a>
      </article>

      <!-- Fiji – Suva -->
      <article class="cmms-contact-form-loc-card cmms-contact-form-loc-card--fj">
        <header class="cmms-contact-form-loc-header">
          <span class="cmms-contact-form-loc-icon">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7zm0 9.5A2.5 2.5 0 1 1 12 6a2.5 2.5 0 0 1 0 5.5z" />
            </svg>
          </span>
          <h3 class="cmms-contact-form-loc-title">Fiji – Suva</h3>
        </header>
        <p class="cmms-contact-form-loc-phone"><strong>Phone: </strong>+679 9488589</p>
        <p class="cmms-contact-form-loc-email"><strong>Email: </strong><a href="mailto:enquiries@iengaust.com.au">enquiries@iengaust.com.au</a></p>
        <p class="cmms-contact-form-loc-address">Suva, Fiji.</p>
        <a class="cmms-contact-form-loc-map" target="_blank" rel="noopener"
           href="https://www.google.com/maps/search/Lot+17,+River+Drive+Pacific+Harbour+Navua+Suva+Fiji/">
          View map
        </a>
      </article>

    </div>
  </section>

  <!-- Toast styles + container (NOT inside a form) -->
  <style>
    .toast-root {
      position: fixed;
      left: 50%;
      top: 16px;
      transform: translateX(-50%);
      z-index: 9999;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .toast {
      min-width: 260px;
      max-width: 360px;
      padding: 12px 14px;
      border-radius: 10px;
      color: #fff;
      box-shadow: 0 10px 30px rgba(0,0,0,.15);
      font: 600 14px/1.4 system-ui;
    }
    .toast--error { background: #d72c2c; }
    .toast--success { background: #0c8c73; }
    .toast--info { background: #0b2239; }
    .toast__close {
      background: transparent;
      border: 0;
      color: #fff;
      font-size: 18px;
      cursor: pointer;
      margin-left: 8px;
    }
    .toast__row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }
  </style>

  <div id="toast-root" class="toast-root" aria-live="polite"></div>

  <script>
    function showToast(msg, type = 'info', ms = 3500) {
      const root = document.getElementById('toast-root');
      if (!root) return;

      const el = document.createElement('div');
      el.className = 'toast toast--' + (type || 'info');
      el.innerHTML =
        '<div class="toast__row">' +
          '<span>' + msg + '</span>' +
          '<button class="toast__close" aria-label="Close">×</button>' +
        '</div>';

      root.appendChild(el);

      const t = setTimeout(() => el.remove(), ms);
      el.querySelector('.toast__close').onclick = () => { clearTimeout(t); el.remove(); };
    }

    document.addEventListener('DOMContentLoaded', function () {
      {% for m in messages %}
        showToast({{ m.message|escapejs }}, '{{ m.tags|default:"info" }}');
      {% endfor %}
    });
  </script>

  <!-- Contact submit button loading (normal POST) -->
  <script>
    (function () {
      const form = document.getElementById('contact');
      const btn = document.getElementById('contactSubmit');
      if (!form || !btn) return;

      let submitting = false;

      function start() {
        btn.classList.add('cmms-contact-form-btnloading');
        btn.disabled = true;
      }
      function stop() {
        submitting = false;
        btn.classList.remove('cmms-contact-form-btnloading');
        btn.disabled = false;
      }

      window.addEventListener('pageshow', stop);
      form.addEventListener('invalid', stop, true);

      form.addEventListener('submit', function (e) {
        if (submitting) { e.preventDefault(); return; }
        if (!form.checkValidity()) { stop(); return; }

        submitting = true;
        start();

        window.clearTimeout(form._safetyTimer);
        form._safetyTimer = window.setTimeout(() => { if (submitting) stop(); }, 15000);
      });

      window.addEventListener('load', stop);
    })();
  </script>

  <!-- Google Tag Manager (noscript) -->
  <noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TKQV8LKX"
            height="0" width="0" style="display:none;visibility:hidden"></iframe>
  </noscript>
  <!-- End Google Tag Manager (noscript) -->

  {% include 'footer.html' %}
  <script src="{% static 'js/main.js' %}"></script>
</body>
</html>
